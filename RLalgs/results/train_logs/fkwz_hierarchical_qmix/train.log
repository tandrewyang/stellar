/root/miniconda3/envs/py310_sc2/lib/python3.10/site-packages/sacred/dependencies.py:11: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
[DEBUG 10:47:29] git.cmd Popen(['git', 'version'], cwd=/share/project/ytz/RLproject/StarCraft2_HLSMAC/RLalgs/HierarchicalArchitecture, stdin=None, shell=False, universal_newlines=False)
[DEBUG 10:47:29] git.cmd Popen(['git', 'version'], cwd=/share/project/ytz/RLproject/StarCraft2_HLSMAC/RLalgs/HierarchicalArchitecture, stdin=None, shell=False, universal_newlines=False)
[DEBUG 10:47:29] git.util sys.platform='linux', git_executable='git'
[DEBUG 10:47:29] git.cmd Popen(['git', 'diff', '--cached', '--abbrev=40', '--full-index', '--raw'], cwd=/share/project/ytz/RLproject/StarCraft2_HLSMAC, stdin=None, shell=False, universal_newlines=False)
[DEBUG 10:47:29] git.cmd Popen(['git', 'diff', '--abbrev=40', '--full-index', '--raw'], cwd=/share/project/ytz/RLproject/StarCraft2_HLSMAC, stdin=None, shell=False, universal_newlines=False)
[DEBUG 10:47:29] git.cmd Popen(['git', 'cat-file', '--batch-check'], cwd=/share/project/ytz/RLproject/StarCraft2_HLSMAC, stdin=<valid stream>, shell=False, universal_newlines=False)
[DEBUG 10:47:30] git.util sys.platform='linux', git_executable='git'
[DEBUG 10:47:30] git.cmd Popen(['git', 'diff', '--cached', '--abbrev=40', '--full-index', '--raw'], cwd=/share/project/ytz/RLproject/StarCraft2_HLSMAC, stdin=None, shell=False, universal_newlines=False)
[DEBUG 10:47:30] git.cmd Popen(['git', 'diff', '--abbrev=40', '--full-index', '--raw'], cwd=/share/project/ytz/RLproject/StarCraft2_HLSMAC, stdin=None, shell=False, universal_newlines=False)
[DEBUG 10:47:30] git.cmd Popen(['git', 'cat-file', '--batch-check'], cwd=/share/project/ytz/RLproject/StarCraft2_HLSMAC, stdin=<valid stream>, shell=False, universal_newlines=False)
[INFO 10:47:30] root Saving to FileStorageObserver in /share/project/ytz/RLproject/StarCraft2_HLSMAC/RLalgs/HierarchicalArchitecture/results/sacred/fkwz/hierarchical_qmix_env=4_adam_td_lambda.
[DEBUG 10:47:31] pymarl Using capture mode "fd"
[INFO 10:47:31] pymarl Running command 'my_main'
[INFO 10:47:31] pymarl Started run with ID "3"
[DEBUG 10:47:31] pymarl Starting Heartbeat
[DEBUG 10:47:31] my_main Started
[INFO 10:47:31] my_main Experiment Parameters:
[INFO 10:47:31] my_main 

{   'action_selector': 'epsilon_greedy',
    'agent': 'hierarchical_rnn',
    'agent_output_type': 'q',
    'alpha_init': -0.07,
    'alpha_lr': '3e-4',
    'batch_size': 128,
    'batch_size_run': 1,
    'buffer_cpu_only': True,
    'buffer_size': 5000,
    'c_beta': 1.0,
    'central_action_embed': 1,
    'central_agent': 'central_rnn',
    'central_loss': 1,
    'central_mac': 'basic_central_mac',
    'central_mixer': 'ff',
    'central_mixing_embed_dim': 256,
    'central_rnn_hidden_dim': 64,
    'checkpoint_path': '',
    'comm': True,
    'comm_beta': 0.001,
    'comm_beta_end_decay': 50000000,
    'comm_beta_start_decay': 20000000,
    'comm_beta_target': '1e-2',
    'comm_embed_dim': 3,
    'comm_entropy_beta': '1e-6',
    'comm_entropy_beta_end_decay': 50000000,
    'comm_entropy_beta_start_decay': 20000000,
    'comm_entropy_beta_target': '1e-4',
    'comm_method': 'information_bottleneck_full',
    'critic_agent': 'rnn_agent_n',
    'critic_lr': 0.0005,
    'critic_mac': 'cate_broadcast_comm_mac_full',
    'cut_mu_rank_thres': 80.0,
    'cut_mu_thres': 1.0,
    'double_q': True,
    'env': 'sc2_tactics',
    'env_args': {   'continuing_episode': False,
                    'debug': False,
                    'difficulty': '7',
                    'game_version': None,
                    'heuristic_ai': False,
                    'heuristic_rest': False,
                    'map_name': 'fkwz',
                    'move_amount': 2,
                    'obs_all_health': True,
                    'obs_instead_of_state': False,
                    'obs_last_action': False,
                    'obs_own_health': True,
                    'obs_pathing_grid': True,
                    'obs_terrain_height': True,
                    'obs_timestep_number': False,
                    'replay_dir': '',
                    'replay_prefix': '',
                    'reward_death_value': 10,
                    'reward_defeat': 0,
                    'reward_negative_scale': 0.5,
                    'reward_only_positive': False,
                    'reward_scale': True,
                    'reward_scale_rate': 20,
                    'reward_sparse': False,
                    'reward_win': 200,
                    'seed': 42,
                    'state_last_action': True,
                    'state_timestep_number': False,
                    'step_mul': 8},
    'epsilon_anneal_time': 100000,
    'epsilon_finish': 0.05,
    'epsilon_start': 0.995,
    'evaluate': False,
    'gamma': 0.99,
    'gate_loss_beta': 1e-05,
    'grad_norm_clip': 10,
    'hierarchical_high_dim': 128,
    'hierarchical_n_goals': 8,
    'hierarchical_n_tactics': 4,
    'hypernet_embed': 128,
    'hypernet_layers': 2,
    'hysteretic_qmix': True,
    'is_comm_beta_decay': False,
    'is_comm_entropy_beta_decay': False,
    'is_cur_mu': False,
    'is_print': False,
    'is_rank_cut_mu': False,
    'label': 'default_label',
    'learner': 'max_q_learner',
    'learner_log_interval': 10000,
    'load_step': 0,
    'local_results_path': 'results',
    'log_interval': 10000,
    'lr': 0.001,
    'mac': 'basic_mac_logits',
    'mixer': 'qmix',
    'mixing_embed_dim': 64,
    'name': 'hierarchical_qmix_env=4_adam_td_lambda',
    'obs_agent_id': True,
    'obs_last_action': True,
    'only_downstream': False,
    'optim_alpha': 0.99,
    'optim_eps': 1e-05,
    'p': 0.5,
    'qmix_loss': 1,
    'repeat_id': 1,
    'rnn_hidden_dim': 64,
    'run': 'default',
    'runner': 'episode',
    'runner_log_interval': 10000,
    'save_model': True,
    'save_model_interval': 500000,
    'save_replay': False,
    'seed': 42,
    't_max': 2005000,
    'target_update_interval': 200,
    'td_lambda': 0.6,
    'test_greedy': True,
    'test_interval': 10000,
    'test_nepisode': 32,
    'use_IB': True,
    'use_cuda': True,
    'use_tensorboard': True,
    'w': 0.5}

----------------------
You create a FKWZ env!
----------------------
314
Mixer Size: 
556.611K
namespace(runner='episode', mac='basic_mac_logits', env='sc2_tactics', env_args={'continuing_episode': False, 'difficulty': '7', 'game_version': None, 'map_name': 'fkwz', 'move_amount': 2, 'obs_all_health': True, 'obs_instead_of_state': False, 'obs_last_action': False, 'obs_own_health': True, 'obs_pathing_grid': True, 'obs_terrain_height': True, 'obs_timestep_number': False, 'reward_death_value': 10, 'reward_defeat': 0, 'reward_negative_scale': 0.5, 'reward_only_positive': False, 'reward_scale': True, 'reward_scale_rate': 20, 'reward_sparse': False, 'reward_win': 200, 'replay_dir': '', 'replay_prefix': '', 'state_last_action': True, 'state_timestep_number': False, 'step_mul': 8, 'seed': 42, 'heuristic_ai': False, 'heuristic_rest': False, 'debug': False}, batch_size_run=1, test_nepisode=32, test_interval=10000, test_greedy=True, log_interval=10000, runner_log_interval=10000, learner_log_interval=10000, t_max=2005000, use_cuda=True, buffer_cpu_only=True, use_tensorboard=True, save_model=True, save_model_interval=500000, checkpoint_path='', evaluate=False, load_step=0, save_replay=False, local_results_path='results', gamma=0.99, batch_size=128, buffer_size=5000, lr=0.001, critic_lr=0.0005, optim_alpha=0.99, optim_eps=1e-05, grad_norm_clip=10, agent='hierarchical_rnn', rnn_hidden_dim=64, obs_agent_id=True, obs_last_action=True, repeat_id=1, label='default_label', run='default', action_selector='epsilon_greedy', epsilon_start=0.995, epsilon_finish=0.05, epsilon_anneal_time=100000, critic_mac='cate_broadcast_comm_mac_full', critic_agent='rnn_agent_n', comm=True, comm_embed_dim=3, comm_method='information_bottleneck_full', c_beta=1.0, comm_beta=0.001, comm_entropy_beta='1e-6', gate_loss_beta=1e-05, only_downstream=False, use_IB=True, is_print=False, is_comm_beta_decay=False, comm_beta_start_decay=20000000, comm_beta_target='1e-2', comm_beta_end_decay=50000000, is_comm_entropy_beta_decay=False, comm_entropy_beta_start_decay=20000000, comm_entropy_beta_target='1e-4', comm_entropy_beta_end_decay=50000000, is_cur_mu=False, is_rank_cut_mu=False, cut_mu_thres=1.0, cut_mu_rank_thres=80.0, target_update_interval=200, agent_output_type='q', learner='max_q_learner', double_q=True, mixer='qmix', mixing_embed_dim=64, hypernet_layers=2, hypernet_embed=128, hierarchical_high_dim=128, hierarchical_n_goals=8, hierarchical_n_tactics=4, central_loss=1, qmix_loss=1, w=0.5, hysteretic_qmix=True, central_mixing_embed_dim=256, central_action_embed=1, central_mac='basic_central_mac', central_agent='central_rnn', central_rnn_hidden_dim=64, central_mixer='ff', td_lambda=0.6, alpha_lr='3e-4', alpha_init=-0.07, p=0.5, name='hierarchical_qmix_env=4_adam_td_lambda', seed=42, device='cuda', unique_token='hierarchical_qmix_env=4_adam_td_lambda__2025-11-24_10-47-31', n_agents=9, n_actions=19, state_shape=378, accumulated_episodes=None)
[INFO 10:47:33] my_main Beginning training for 2005000 timesteps
[INFO 10:47:33] absl Launching SC2: /share/project/ytz/StarCraftII/Versions/Base75689/SC2_x64 -listen 127.0.0.1 -port 33813 -dataDir /share/project/ytz/StarCraftII/ -tempDir /tmp/sc-b_80ug5h/
[INFO 10:47:33] absl Connecting to: ws://127.0.0.1:33813/sc2api, attempt: 0, running: True
Version: B75689 (SC2.4.10)
Build: Aug 12 2019 17:16:57
Command Line: '"/share/project/ytz/StarCraftII/Versions/Base75689/SC2_x64" -listen 127.0.0.1 -port 33813 -dataDir /share/project/ytz/StarCraftII/ -tempDir /tmp/sc-b_80ug5h/'
Starting up...
Startup Phase 1 complete
[INFO 10:47:34] absl Connecting to: ws://127.0.0.1:33813/sc2api, attempt: 1, running: True
Startup Phase 2 complete
Creating stub renderer...
Listening on: 127.0.0.1:33813
Startup Phase 3 complete. Ready for commands.
[INFO 10:47:35] absl Connecting to: ws://127.0.0.1:33813/sc2api, attempt: 2, running: True
ConnectHandler: Request from 127.0.0.1:56874 accepted
ReadyHandler: 127.0.0.1:56874 ready
Requesting to join a single player game
Configuring interface options
Configure: raw interface enabled
Configure: feature layer interface disabled
Configure: score interface disabled
Configure: render interface disabled
Launching next game.
Next launch phase started: 2
Next launch phase started: 3
Next launch phase started: 4
Next launch phase started: 5
Next launch phase started: 6
Next launch phase started: 7
Next launch phase started: 8
Game has started.
Using default stable ids, none found at: /share/project/ytz/StarCraftII/stableid.json
Successfully loaded stable ids: GameData\stableid.json
Sending ResponseJoinGame
{'warpgate': 133, 'pylon': 60, 'zealot': 73, 'warpPrism': 81, 'warpPrismPhasing': 136}
/share/project/ytz/RLproject/StarCraft2_HLSMAC/RLalgs/HierarchicalArchitecture/src/components/episode_buffer.py:103: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at ../torch/csrc/utils/tensor_new.cpp:261.)
  v = th.tensor(v, dtype=dtype, device=self.device)
/share/project/ytz/RLproject/StarCraft2_HLSMAC/RLalgs/HierarchicalArchitecture/src/components/episode_buffer.py:103: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  v = th.tensor(v, dtype=dtype, device=self.device)
[INFO 10:47:45] my_main t_env: 234 / 2005000
[INFO 10:47:45] my_main Estimated time left: 39 minutes, 34 seconds. Time passed: 12 seconds
[INFO 10:48:22] my_main Saving models to results/models/hierarchical_qmix_env=4_adam_td_lambda__2025-11-24_10-47-31/234
cannot find a valid point for unit type 136
[INFO 10:50:23] my_main Recent Stats | t_env:      10118 | Episode:       56
battle_won_mean:           0.0000	dead_allies_mean:          5.0000	dead_enemies_mean:         1.0000	delta_ally_mean:         682.2188
delta_deaths_mean:       -15.0000	delta_enemy_mean:        -739.8438	ep_length_mean:          234.0000	epsilon:                   0.9950
reward_mean:              -9.1825	reward_std:                0.0000	test_battle_won_mean:      0.0000	test_dead_allies_mean:     1.8750
test_dead_enemies_mean:    0.0312	test_delta_ally_mean:    225.4902	test_delta_deaths_mean:   -9.0625	test_delta_enemy_mean:   -465.3655
test_ep_length_mean:      99.3438	test_reward_mean:         -4.4723	test_reward_std:           4.0311	
[INFO 10:50:26] my_main t_env: 10341 / 2005000
[INFO 10:50:26] my_main Estimated time left: 8 hours, 48 minutes, 8 seconds. Time passed: 2 minutes, 52 seconds
[INFO 10:53:01] my_main Recent Stats | t_env:      20190 | Episode:      115
battle_won_mean:           0.0000	dead_allies_mean:          3.2679	dead_enemies_mean:         0.1964	delta_ally_mean:         349.2848
delta_deaths_mean:       -14.3750	delta_enemy_mean:        -787.2040	ep_length_mean:          180.4821	epsilon:                   0.8994
reward_mean:              -7.3538	reward_std:                2.8026	test_battle_won_mean:      0.0000	test_dead_allies_mean:     1.7500
test_dead_enemies_mean:    0.0312	test_delta_ally_mean:    185.2524	test_delta_deaths_mean:   -8.4375	test_delta_enemy_mean:   -423.1696
test_ep_length_mean:      87.5938	test_reward_mean:         -3.9416	test_reward_std:           3.9507	
[INFO 10:53:05] my_main t_env: 20404 / 2005000
[INFO 10:53:05] my_main Estimated time left: 8 hours, 41 minutes, 29 seconds. Time passed: 5 minutes, 31 seconds
[INFO 10:57:28] my_main Recent Stats | t_env:      30269 | Episode:      168
alpha:                     0.9323	alpha_loss:              -12.3324	battle_won_mean:           0.0000	central_loss:              0.0091
comm_loss:                 0.3770	dead_allies_mean:          2.9322	dead_enemies_mean:         0.1356	delta_ally_mean:         308.8522
delta_deaths_mean:       -13.3051	delta_enemy_mean:        -787.7937	ep_length_mean:          170.5593	epsilon:                   0.8042
grad_norm:                 2.8364	loss:                      0.4560	mixer_norm:                2.4684	policy_loss:               0.3776
q_taken_mean:              0.0210	qmix_loss:                 0.0700	reward_mean:              -7.0923	reward_std:                2.8386
target_mean:              -0.0164	td_error_abs:              0.3407	test_battle_won_mean:      0.0000	test_dead_allies_mean:     1.8438
test_dead_enemies_mean:    0.0312	test_delta_ally_mean:    204.5078	test_delta_deaths_mean:   -8.9062	test_delta_enemy_mean:   -419.7721
test_ep_length_mean:      89.5312	test_reward_mean:         -4.0459	test_reward_std:           4.1701	w_to_use:                  0.6560

[INFO 10:57:35] my_main t_env: 30482 / 2005000
[INFO 10:57:35] my_main Estimated time left: 14 hours, 42 minutes, 35 seconds. Time passed: 10 minutes, 1 seconds
[INFO 11:03:53] my_main Updated target network
[INFO 11:07:52] my_main Recent Stats | t_env:      40284 | Episode:      222
alpha:                     0.9275	alpha_loss:              -12.3377	battle_won_mean:           0.0000	central_loss:              0.0018
comm_loss:                 0.0455	dead_allies_mean:          3.2642	dead_enemies_mean:         0.1132	delta_ally_mean:         437.8376
delta_deaths_mean:       -15.1887	delta_enemy_mean:        -818.3333	ep_length_mean:          190.1509	epsilon:                   0.7090
grad_norm:                 0.0753	loss:                      0.0501	mixer_norm:                0.0651	policy_loss:              -0.4580
q_taken_mean:             -0.0154	qmix_loss:                 0.0028	reward_mean:              -8.1237	reward_std:                2.6943
target_mean:              -0.0163	td_error_abs:              0.0482	test_battle_won_mean:      0.0000	test_dead_allies_mean:     2.0000
test_dead_enemies_mean:    0.0000	test_delta_ally_mean:    290.0000	test_delta_deaths_mean:  -10.0000	test_delta_enemy_mean:   -898.9785
test_ep_length_mean:     162.5625	test_reward_mean:         -7.6612	test_reward_std:           0.0000	w_to_use:                  0.7984

[INFO 11:08:16] my_main t_env: 40602 / 2005000
[INFO 11:08:16] my_main Estimated time left: 1 days, 10 hours, 32 minutes, 47 seconds. Time passed: 20 minutes, 42 seconds
RequestQuit command received.
Closing Application...
DataHandler: unable to parse websocket frame.
CloseHandler: 127.0.0.1:56874 disconnected
[INFO 11:14:29] absl Shutdown gracefully.
[INFO 11:14:29] absl Shutdown with return code: -15
[INFO 11:14:29] absl Launching SC2: /share/project/ytz/StarCraftII/Versions/Base75689/SC2_x64 -listen 127.0.0.1 -port 37439 -dataDir /share/project/ytz/StarCraftII/ -tempDir /tmp/sc-9zksu9uc/
[INFO 11:14:29] absl Connecting to: ws://127.0.0.1:37439/sc2api, attempt: 0, running: True
Version: B75689 (SC2.4.10)
Build: Aug 12 2019 17:16:57
Command Line: '"/share/project/ytz/StarCraftII/Versions/Base75689/SC2_x64" -listen 127.0.0.1 -port 37439 -dataDir /share/project/ytz/StarCraftII/ -tempDir /tmp/sc-9zksu9uc/'
Starting up...
Startup Phase 1 complete
[INFO 11:14:30] absl Connecting to: ws://127.0.0.1:37439/sc2api, attempt: 1, running: True
Startup Phase 2 complete
Creating stub renderer...
[INFO 11:14:31] absl Connecting to: ws://127.0.0.1:37439/sc2api, attempt: 2, running: True
Listening on: 127.0.0.1:37439
Startup Phase 3 complete. Ready for commands.
[INFO 11:14:32] absl Connecting to: ws://127.0.0.1:37439/sc2api, attempt: 3, running: True
ConnectHandler: Request from 127.0.0.1:35450 accepted
ReadyHandler: 127.0.0.1:35450 ready
Requesting to join a single player game
Configuring interface options
Configure: raw interface enabled
Configure: feature layer interface disabled
Configure: score interface disabled
Configure: render interface disabled
Launching next game.
Next launch phase started: 2
Next launch phase started: 3
Next launch phase started: 4
Next launch phase started: 5
Next launch phase started: 6
Next launch phase started: 7
Next launch phase started: 8
Game has started.
Using default stable ids, none found at: /share/project/ytz/StarCraftII/stableid.json
Successfully loaded stable ids: GameData\stableid.json
Sending ResponseJoinGame
[INFO 11:19:26] my_main Recent Stats | t_env:      50382 | Episode:      282
alpha:                     0.9224	alpha_loss:              -12.3358	battle_won_mean:           0.0000	central_loss:              0.0020
comm_loss:                 0.0319	dead_allies_mean:          3.2727	dead_enemies_mean:         0.3818	delta_ally_mean:         304.0053
delta_deaths_mean:       -12.5455	delta_enemy_mean:        -770.5562	ep_length_mean:          184.0000	epsilon:                   0.6132
grad_norm:                 0.0933	loss:                      0.0374	mixer_norm:                0.0726	policy_loss:              -0.5128
q_taken_mean:             -0.0257	qmix_loss:                 0.0036	reward_mean:              -6.9464	reward_std:                2.5012
target_mean:              -0.0265	td_error_abs:              0.0526	test_battle_won_mean:      0.0000	test_dead_allies_mean:     4.3750
test_dead_enemies_mean:    0.2500	test_delta_ally_mean:    378.3711	test_delta_deaths_mean:  -19.3750	test_delta_enemy_mean:   -846.8418
test_ep_length_mean:     206.0000	test_reward_mean:         -7.9526	test_reward_std:           0.9251	w_to_use:                  0.7870

[INFO 11:19:41] my_main t_env: 50808 / 2005000
[INFO 11:19:41] my_main Estimated time left: 1 days, 12 hours, 27 minutes, 58 seconds. Time passed: 32 minutes, 7 seconds
/root/miniconda3/envs/py310_sc2/lib/python3.10/site-packages/sacred/stdout_capturing.py:179: UserWarning: tee_stdout.wait timeout. Forcibly terminating.
  warnings.warn("tee_stdout.wait timeout. Forcibly terminating.")
/root/miniconda3/envs/py310_sc2/lib/python3.10/site-packages/sacred/stdout_capturing.py:185: UserWarning: tee_stderr.wait timeout. Forcibly terminating.
  warnings.warn("tee_stderr.wait timeout. Forcibly terminating.")
[DEBUG 11:23:15] pymarl Stopping Heartbeat
[ERROR 11:23:15] pymarl Failed after 0:35:44!
Traceback (most recent calls WITHOUT Sacred internals):
  File "/share/project/ytz/RLproject/StarCraft2_HLSMAC/RLalgs/HierarchicalArchitecture/src/main.py", line 53, in my_main
    run_REGISTRY[_config['run']](_run, config, _log)
  File "/share/project/ytz/RLproject/StarCraft2_HLSMAC/RLalgs/HierarchicalArchitecture/src/run/run.py", line 54, in run
    run_sequential(args=args, logger=logger)
  File "/share/project/ytz/RLproject/StarCraft2_HLSMAC/RLalgs/HierarchicalArchitecture/src/run/run.py", line 197, in run_sequential
    learner.train(episode_sample, runner.t_env, episode)
  File "/share/project/ytz/RLproject/StarCraft2_HLSMAC/RLalgs/HierarchicalArchitecture/src/learners/max_q_learner.py", line 271, in train
    policy_loss.backward(retain_graph=True)
  File "/root/miniconda3/envs/py310_sc2/lib/python3.10/site-packages/torch/_tensor.py", line 492, in backward
    torch.autograd.backward(
  File "/root/miniconda3/envs/py310_sc2/lib/python3.10/site-packages/torch/autograd/__init__.py", line 251, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 74.00 MiB. GPU 0 has a total capacty of 79.11 GiB of which 74.25 MiB is free. Process 3254864 has 17.71 GiB memory in use. Process 3337907 has 37.54 GiB memory in use. Process 3347464 has 944.00 MiB memory in use. Process 3351344 has 22.83 GiB memory in use. Of the allocated memory 16.25 GiB is allocated by PyTorch, and 380.80 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF

[INFO 11:23:16] absl Shutdown gracefully.
[INFO 11:23:16] absl Shutdown with return code: -15
